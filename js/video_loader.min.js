!function(i,e){if(void 0!==e){var t=e.PlayerManager,o=e.PlayerObserver.SimpleVideoPlayerObserver,s=(e.convertURL2URI,"undefined"!=typeof navigator&&"mediaSession"in navigator&&navigator.mediaSession||null),n=function(){function e(e){this._$wrapper=e,this._player=[],this._destructed=!1,this._onResizeHandler=this._onResize.bind(this),i(window).on("resize",this._onResizeHandler)}return e.prototype._onResize=function(i){var e=this._$wrapper.innerWidth();e&&this._resizeAllPlayer(e)},e.prototype._resizeAllPlayer=function(i){i||(i=this._$wrapper.innerWidth());var e=this;this._player.forEach(function(t){e._resizePlayer(t,i)})},e.prototype._resizePlayer=function(e,t){void 0===t&&(t=this._$wrapper.innerWidth());var o,s,n,r=e.getResolution(),a=e.getPlayer();if(t&&r&&a){var d=(o=r.width,s=r.height,n=t/o,{width:Math.min(o,parseInt(o*n,10)),height:Math.min(s,parseInt(s*n,10))});i(a).css({width:d.width,height:d.height})}},e.prototype.registerPlayer=function(i){-1===this._player.indexOf(i)&&(this._player.push(i),this._resizePlayer(i))},e.prototype.unregisterPlayer=function(i){var e=this._player.indexOf(i);e>-1&&this._player.splice(e,1)},e.prototype.destruct=function(){this._destructed||(i(window).off("resize",this._onResizeHandler),this._player=[],this._destructed=!0)},e}(),r=function(){var i=0,e=10;function t(t,o){this._id=i++,this._description=t,this._video=document.createElement("video"),this._loop=o.loop,this._mute=o.mute,this._gifMode=o.gifMode,this._onVideoPlayingHandler=this._onVideoPlaying.bind(this),this._onVideoEndedHandler=this._onVideoEnded.bind(this),this._onVideoClickHandler=this._onVideoClick.bind(this),this._autoplay=o.autoplay,this._preload=o.preload,this._enableMediaSession=o.enableMediaSession,this._mediaSessionForwardTime=void 0!==o.mediaSessionForwardTime?o.mediaSessionForwardTime:e,this._mediaSessionBackwardTime=void 0!==o.mediaSessionBackwardTime?o.mediaSessionBackwardTime:e,this._playsinline=o.playsinline,this._src=o.src,this._title=o.title,this._artist=o.artist,this._album=o.album,this._albumArt=o.albumArt,this._poster=o.poster||null,this._width=o.width,this._height=o.height,this._hasAudio=o.hasAudio,this._ifClickToShowControls=o.ifClickToShowControls,this._init()}return t.prototype._init=function(){this._video.addEventListener("playing",this._onVideoPlayingHandler,!1),this._video.addEventListener("ended",this._onVideoEndedHandler,!1),this._video.addEventListener("click",this._onVideoClickHandler,!1),this._video.preload=this._gifMode?"auto":this._preload,this._video.controls=!0,this._video.setAttribute("controlslist",["nodownload"]),(this._playsinline||this._gifMode)&&(this._video.setAttribute("playsinline",""),this._video.setAttribute("webkit-playsinline","")),this._poster&&this._video.setAttribute("poster",this._poster),this._gifMode&&this._video.hasAttribute("controls")&&this._video.removeAttribute("controls"),(this._mute||this._gifMode)&&(this._video.muted=!0),this._gifMode||this._video.setAttribute("controls","controls"),this._video.src=this._src,this._video.load(),this._autoplay&&this.play()},t.prototype._onVideoPlaying=function(){!this._gifMode&&this._enableMediaSession&&(this._registerMediaSessionHandlers(),this._updateMediaSessionMetadata())},t.prototype._onVideoEnded=function(){this._loop&&!isNaN(this._video.duration)&&this._video.duration&&(this.seek(0),this.play())},t.prototype._onVideoClick=function(){this._ifClickToShowControls&&this._video&&!this._video.hasAttribute("controls")&&this._video.setAttribute("controls","")},t.prototype.seek=function(){!isNaN(this._video.duration)&&this._video.duration&&(this._video.currentTime=0)},t.prototype.play=function(){if(!isNaN(this._video.duration)&&this._video.duration){var i=this._video.play();i&&i.catch(function(i){console.error(i)})}else this._video.setAttribute("autoplay","autoplay")},t.prototype._updateMediaSessionMetadata=function(){s&&(s.metadata=new window.MediaMetadata({title:this._title?this._title:void 0,artist:this._artist?this._artist:void 0,album:this._album?this._album:void 0,artwork:this._poster?[{src:this._poster}]:this._albumArt?[{src:this._albumArt}]:void 0}))},t.prototype._registerMediaSessionHandlers=function(){if(s){var i=this;s.setActionHandler("play",function(){i._video.play()}),s.setActionHandler("pause",function(){i._video.pause()}),s.setActionHandler("seekbackward",function(){i._video.currentTime=Math.max(0,i._video.currentTime-i._mediaSessionBackwardTime)}),s.setActionHandler("seekforward",function(){i._video.currentTime=Math.min(i._video.duration||0,i._video.currentTime+i._mediaSessionForwardTime)}),s.setActionHandler("previoustrack",null),s.setActionHandler("nexttrack",null)}},t.prototype.getVideoNode=function(){return this._video},t.prototype.getPlayer=function(){return this._video},t.prototype.getResolution=function(){return this._width&&this._height?{width:this._width,height:this._height}:null},t.prototype.destruct=function(){this._destruct||(this._video.removeEventListener("playing",this._onVideoPlayingHandler,!1),this._video.removeEventListener("ended",this._onVideoEndedHandler,!1),this._video.removeEventListener("click",this._onVideoClickHandler,!1),this._destruct=!0)},t}();i(document).ready(function(){var s=function(s){a&&(a.remove(),a=null),s&&s.length&&function(s){var a=i(".xe_content[class*=document_]");if(a.length){var d=e.config,l=d.default_cover,h=d.use_thumbnail,_=d.link_to_media,u=d.use_mediasession,c=d.mediasession_backward_time,p=d.mediasession_forward_time,v=d.enable_video,f=d.enable_webm,m=d.video_autoplay,y=d.video_autoplay_without_audio,g=d.video_playsinline,w=d.video_loop,b=d.video_loop_without_audio,A=d.video_gif_without_audio,k=d.video_gif_mode_if_click,M=d.video_preload,S=d.video_resize,P=d.video_auto_attach,H=d.video_thumbnail_poster;if(v){var T=S?new n(a):null,V=[],E=[],z=[],C=[],x=function(i){var e=i.stream,t=e.video?e.video:null,o=!e.isAudio&&A,s=e.isAudio?m:y,n=e.isAudio?w:b,a=M,d=i.filePath,_=i.tags?i.tags:null,v=document.title,S=_&&_.albumArt?_.albumArt:null,P=H&&i.poster?i.poster:null,T=t&&t.resolution_x?t.resolution_x:null,V=t&&t.resolution_y?t.resolution_y:null,E=!!e&&e.isAudio,z=e?e.fileformat:null;return f||"webm"!==z?(!S&&h&&i.thumbnail&&(S=i.thumbnail),!S&&l&&(S=l),o&&(a="auto",s=!0,n=!0),e&&T&&V?new r(i,{loop:n,autoplay:!E&&s,preload:a,gifMode:o,playsinline:g,enableMediaSession:E&&u,mediaSessionBackwardTime:c,mediaSessionForwardTime:p,title:v,artist:null,album:null,albumArt:S,poster:P,width:T,height:V,hasAudio:E,ifClickToShowControls:k,src:d}):null):null};if(_){var N=[];a.find("audio, video").each(function(e,t){var o=i(this),s=o.find("source");s.length&&s.each(function(e,t){var o=i(this).attr("src");o&&N.push(o)});var n=o.attr("src");n&&N.push(n)});var R=function(i){return N.find(function(e){return e.indexOf(i)>-1||i.indexOf(e)>-1})};a.find("a").each(function(){var e=i(this),t=e.attr("href"),o=e.attr("data-file-srl")||null,n=o?parseInt(o,10):NaN,r=s.find(function(i){var e=i.description,o=e&&e.uploaded_filename?e.uploaded_filename.replace(/^.\/files/i,"/files"):null;return n&&!isNaN(n)&&e.file_srl===n||o&&t&&t.indexOf(o)>-1});if(r){var a=r.description,d=x(a);d&&(E.push(d),e.replaceWith(d.getPlayer()),V.push(a),T&&T.registerPlayer(d))}})}P&&s.filter(function(i){return i.description&&-1===V.indexOf(i.description)}).reverse().forEach(function(e){var t=e.description;if(!R(t.uploaded_filename)){var o=x(t);if(o){C.unshift(o);var s=i("<p></p>");s.append(o.getPlayer()),a.prepend(s),z.push(t),T&&T.registerPlayer(o)}}}),E.concat(C).forEach(function(i){!i._gifMode&&i._hasAudio&&t.registerPlayer(new o(i))})}}}(s)},a=null;e.videoDescriptions&&e.videoDescriptions.length>0?s(e.videoDescriptions):a=e.onVideoDescriptionLoad.subscribe(s)})}}(window.jQuery,window.$SimpleMP3Player);